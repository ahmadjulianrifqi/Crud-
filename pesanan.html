<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pesanan Anda</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100">

<!-- Navbar -->
<div class="fixed top-0 left-0 right-0 bg-white shadow-md z-50 p-3 flex justify-between items-center">
    <h1 class="text-2xl font-bold">Belandja</h1>
    <a href="index.html" class="text-emerald-500 hover:text-emerald-700">Kembali</a>
</div>

<div class="pt-20 container mx-auto p-5">
    <h2 class="text-2xl font-bold mb-4">Pesanan Anda</h2>
    <div id="cartContainer" class="space-y-4"></div>

    <div class="mt-5">
        <h3 class="text-xl font-semibold mb-2">Metode Pembayaran</h3>
        <select id="paymentMethod" class="w-full p-2 rounded bg-slate-200 mb-3">
            <option value="" disabled selected>Pilih metode pembayaran</option>
            <optgroup label="Bank">
                <option value="bca">BCA</option>
                <option value="bri">BRI</option>
                <option value="mandiri">Mandiri</option>
                <option value="muamalat">Muamalat</option>
            </optgroup>
            <optgroup label="E-Wallet">
                <option value="ovo">OVO</option>
                <option value="dana">Dana</option>
                <option value="shopeepay">ShopeePay</option>
            </optgroup>
        </select>
        <button id="checkoutBtn" class="bg-emerald-500 text-white px-4 py-2 rounded hover:bg-emerald-600">Bayar Sekarang</button>
    </div>
</div>

<!-- Modal Struk -->
<div id="receiptModal" class="fixed inset-0 bg-black/50 flex justify-center items-center hidden z-50">
    <div class="bg-white p-5 rounded w-80 relative">
        <h2 class="text-xl font-bold mb-3 text-center">Struk Pembelian</h2>
        <div id="receiptContent" class="space-y-2"></div>
        <div class="flex justify-between mt-5">
            <button id="closeReceipt" class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400">Tutup</button>
            <button id="printReceipt" class="bg-emerald-500 px-4 py-2 rounded text-white hover:bg-emerald-600">Cetak Struk</button>
        </div>
    </div>
</div>

<script>
const cart = JSON.parse(localStorage.getItem('cart')) || [];
const container = document.getElementById('cartContainer');
const paymentMethod = document.getElementById('paymentMethod');
const receiptModal = document.getElementById('receiptModal');
const receiptContent = document.getElementById('receiptContent');
const closeReceipt = document.getElementById('closeReceipt');
const printReceipt = document.getElementById('printReceipt');

function renderCart() {
    container.innerHTML = '';
    if(cart.length === 0){
        container.innerHTML = '<p class="text-gray-500">Belum ada pesanan.</p>';
        return;
    }

    cart.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = "bg-white p-3 rounded shadow flex justify-between items-center";
        div.innerHTML = `
            <span>${item.name}</span>
            <div class="flex items-center gap-2">
                <span>Rp. ${item.price.toLocaleString()}</span>
                <button onclick="removeItem(${index})" class="text-red-500 hover:text-red-700">Hapus</button>
            </div>
        `;
        container.appendChild(div);
    });

    const total = cart.reduce((acc, cur) => acc + cur.price, 0);
    const totalDiv = document.createElement('div');
    totalDiv.className = "bg-emerald-100 p-3 rounded shadow font-bold flex justify-between";
    totalDiv.innerHTML = `<span>Total</span><span>Rp. ${total.toLocaleString()}</span>`;
    container.appendChild(totalDiv);
}

function removeItem(index){
    cart.splice(index, 1);
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
}

renderCart();

document.getElementById('checkoutBtn').addEventListener('click', () => {
    if(cart.length === 0) return alert("Belum ada pesanan!");
    if(!paymentMethod.value) return alert("Pilih metode pembayaran terlebih dahulu!");

    const total = cart.reduce((acc, cur) => acc + cur.price, 0);
    const method = paymentMethod.value;

    // Tentukan logo bank/ewalet
    const logos = {
        bca: 'https://upload.wikimedia.org/wikipedia/commons/7/7e/BCA_logo.svg',
        bri: 'https://upload.wikimedia.org/wikipedia/commons/0/05/BRI_logo.svg',
        mandiri: 'https://upload.wikimedia.org/wikipedia/commons/2/2c/Mandiri_logo.svg',
        muamalat: 'https://upload.wikimedia.org/wikipedia/commons/8/81/Bank_Muamalat_logo.svg',
        ovo: 'https://seeklogo.com/images/O/ovo-logo-FFCC00B02B-seeklogo.com.png',
        dana: 'https://upload.wikimedia.org/wikipedia/commons/8/86/Dana_logo.svg',
        shopeepay: 'https://upload.wikimedia.org/wikipedia/commons/3/3f/ShopeePay_logo.svg'
    };
    const logoImg = logos[method] || '';

    // Tanggal & waktu
    const date = new Date().toLocaleString();

    // Buat struk
    receiptContent.innerHTML = `
        <div class="text-center mb-3">${logoImg ? `<img src="${logoImg}" class="w-20 mx-auto mb-2">` : ''}</div>
        ${cart.map(item => `<div class="flex justify-between border-b py-1"><span>${item.name}</span><span>Rp. ${item.price.toLocaleString()}</span></div>`).join('')}
        <div class="flex justify-between font-bold border-t pt-1"><span>Total</span><span>Rp. ${total.toLocaleString()}</span></div>
        <div class="mt-2">Metode: ${method.toUpperCase()}</div>
        <div>Tanggal: ${date}</div>
    `;

    receiptModal.classList.remove('hidden');

    // Hapus cart setelah bayar
    localStorage.removeItem('cart');
    renderCart();
});

closeReceipt.addEventListener('click', () => receiptModal.classList.add('hidden'));
printReceipt.addEventListener('click', () => window.print());
</script>

</body>
</html>
